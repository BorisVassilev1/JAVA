#version 450

#ifdef GL_ES
precision highp float;
#endif

layout(local_size_x = 1, local_size_y = 1) in;
layout(rgba32f, binding = 0) uniform image2D img_output;

uniform int deltaTime;
uniform vec2 resolution;

vec2 points[] =
 {vec2(450.854,0.750732), vec2(658.252,537.561), vec2(11.9873,182.391), vec2(95.2637,267.407), vec2(485.718,361.047),
  vec2(626.636,364.6), vec2(740.552,573.523), vec2(623.706,125.757), vec2(237.817,159.723), vec2(7.03125,33.728),
  vec2(581.177,502.551), vec2(595.532,569.476), vec2(289.062,343.433), vec2(601.221,593.976), vec2(403.833,419.843),
  vec2(341.235,181.824), vec2(465.625,492.993), vec2(585.596,302.344), vec2(380.225,433.136), vec2(340.967,397.778), 
  };/*vec2(299.976,283.026), vec2(591.333,178.674), vec2(712.109,300.531), vec2(674.414,116.437), vec2(594.482,65.9546), 
  vec2(667.676,439.838), vec2(48.8037,0.970459), vec2(91.0156,8.55103), vec2(161.548,262.024), vec2(502.93,319.537),
  vec2(268.75,113.965), vec2(75.5127,375.092), vec2(615.234,136.377), vec2(478.247,279.803), vec2(300.098,339.441),
  vec2(483.765,113.361), vec2(489.624,444.434), vec2(729.224,520.624), vec2(455.347,189.001), vec2(123.901,446.576),
  vec2(358.594,327.045), vec2(590.381,193.817), vec2(755.176,180.029), vec2(57.8125,573.651), vec2(232.227,136.249),
  vec2(397.437,227.472), vec2(316.138,363.757), vec2(597.852,294.891), vec2(504.663,573.413), vec2(22.2656,367.181),
  vec2(477.49,518.573), vec2(174.048,370.276), vec2(528.784,220.532), vec2(115.845,540.344), vec2(342.236,39.6973),
  vec2(646.411,66.3757), vec2(492.163,446.265), vec2(433.911,149.725), vec2(207.031,56.7993), vec2(37.6709,48.0652),
  vec2(669.727,567.682), vec2(420.459,2.6001), vec2(756.201,410.394), vec2(461.328,471.68), vec2(527.93,49.3469),
  vec2(424.097,481.604), vec2(694.922,18.6401), vec2(219.971,35.2661), vec2(555.615,220.514), vec2(722.095,63.8489),
  vec2(696.289,465.509), vec2(248.901,242.816), vec2(496.24,92.1021), vec2(727.295,394.043), vec2(337.622,341.711),
  vec2(280.2,238.165), vec2(56.7383,354.437), vec2(353.027,418.396), vec2(700.781,569.659), vec2(501.855,265.228),
  vec2(568.14,537.177), vec2(310.474,185.156), vec2(111.45,443.646), vec2(87.5,310.583), vec2(72.3389,412.573), 
  vec2(114.136,418.359), vec2(492.554,416.4), vec2(371.216,584.729), vec2(310.889,223.26), vec2(169.971,470.673), 
  vec2(606.812,363.556), vec2(42.7734,598.352), vec2(490.039,16.0217), vec2(321.509,562.042), vec2(63.208,357.001), 
  vec2(538.184,489.624), vec2(297.388,462.598), vec2(428.442,109.808), vec2(762.695,478.436), vec2(200.513,158.99)};
*/
vec2 vel[] = 
 {vec2(1.54358,-1.53351), vec2(-1.62949,1.23291), vec2(-0.677795,-2.043), vec2(-2.45544,-2.47665), vec2(0.815125,-1.66885),
  vec2(0.0993347,1.51291), vec2(-1.78833,0.196686), vec2(2.48383,1.71814), vec2(-2.38129,1.70059), vec2(-1.12061,2.09381),
  vec2(-1.47324,-0.0753784), vec2(0.495148,-1.95862), vec2(-1.37451,-1.74225), vec2(-1.65512,-0.772247), vec2(2.24777,-1.76254),
  vec2(2.33292,-2.14813), vec2(-1.61057,-1.54327), vec2(-1.10214,-0.472107), vec2(-0.661011,-1.88492), vec2(2.24655,-1.97662),
  };/*vec2(-0.91568,1.73477), vec2(-1.52008,0.336304), vec2(2.47299,-2.36267), vec2(0.787964,0.633698), vec2(2.2052,-0.929718),
  vec2(0.501099,1.03989), vec2(1.763,1.53107), vec2(1.26099,-0.227509), vec2(-1.04828,0.980988), vec2(0.0205994,-1.69907),
  vec2(2.47574,-1.60828), vec2(2.15744,-0.311432), vec2(-1.49017,-0.446472), vec2(1.77383,0.673523), vec2(1.18942,-1.57867),
  vec2(0.422974,0.992432), vec2(0.955505,0.601807), vec2(1.13831,0.573425), vec2(-1.6304,-0.970917), vec2(-2.10327,-0.865479),
  vec2(-1.00632,-0.45517), vec2(1.6333,-0.930634), vec2(-2.17133,-1.86386), vec2(0.769196,1.87805), vec2(0.255737,2.09976),
  vec2(0.0462341,1.46667), vec2(1.03928,-2.47055), vec2(-0.599518,-0.015564), vec2(-0.628815,-1.61713), vec2(-2.22046,-0.85083),
  vec2(1.76971,1.10809), vec2(-1.65543,-2.17026), vec2(1.53427,1.51184), vec2(-0.487976,0.650787), vec2(-0.988617,0.366669),
  vec2(-1.0788,-1.82648), vec2(1.78314,-0.694427), vec2(-2.23099,2.42401), vec2(-1.33621,1.95755), vec2(-0.818024,-2.20642),
  vec2(1.71036,0.171051), vec2(-0.506592,2.27386), vec2(1.95099,-0.322571), vec2(-1.3884,-1.78787), vec2(-2.17575,1.77536),
  vec2(-1.78619,0.92804), vec2(1.03271,0.722504), vec2(2.40875,-1.77414), vec2(-1.72043,-1.40686), vec2(-2.09946,-0.291443),
  vec2(-0.21698,-1.44684), vec2(-2.30713,2.46292), vec2(2.19528,1.92673), vec2(2.10632,-0.222778), vec2(0.202789,2.21497),
  vec2(1.47614,-2.31689), vec2(-1.72058,-1.51169), vec2(-0.517426,0.922241), vec2(2.43713,-0.541534), vec2(-2.25189,1.04248),
  vec2(1.98013,1.14212), vec2(-0.732269,0.352783), vec2(-1.13708,-1.49918), vec2(-1.48468,2.03705), vec2(-2.12112,-2.1022),
  vec2(-2.1608,-0.525818), vec2(0.219879,0.774384), vec2(1.13922,2.3497), vec2(1.54877,-2.25021), vec2(-0.0767517,-0.890503),
  vec2(-0.751038,-0.49469), vec2(1.81763,0.314178), vec2(-2.40692,-0.544128), vec2(0.557861,1.13632), vec2(-0.189056,1.46576),
  vec2(-2.44888,-0.782166), vec2(-1.91574,1.84921), vec2(1.4003,2.00989), vec2(1.9516,1.74393), vec2(1.44043,1.16089)};
*/
vec3 col[] = 
 {vec3(0.34902,0.478431,0.584314), vec3(0.509804,0.709804,0.858824), vec3(0.988235,0.164706,0.145098), vec3(0.568627,0.529412,0.376471), vec3(0.054902,0.34902,0.447059),
vec3(0.72549,0.87451,0.298039), vec3(0.858824,0.235294,0.458824), vec3(0.392157,0.607843,0.996078), vec3(0.67451,0.0901961,0.372549), vec3(0.690196,0.584314,0.270588),
vec3(0.454902,0.466667,0.741176), vec3(0.607843,0.733333,0.384314), vec3(0.513725,0.8,0.423529), vec3(0.0627451,0.490196,0.654902), vec3(0.690196,0.901961,0.141176),
vec3(0.87451,0.152941,0.682353), vec3(0.152941,0.47451,0.815686), vec3(0.752941,0.678431,0.568627), vec3(0.513725,0.0313725,0.831373), vec3(0.345098,0.54902,0.917647),
};/*vec3(0.980392,0.270588,0.454902), vec3(0.396078,0.839216,0.760784), vec3(0.529412,0.0470588,0.572549), vec3(0.121569,0.839216,0.196078), vec3(0.137255,0.333333,0.282353),
vec3(0.141176,0.25098,0.745098), vec3(0.552941,0.113725,0.207843), vec3(0.0705882,0.541176,0.682353), vec3(0.576471,0.231373,0.435294), vec3(0.921569,0.694118,0.960784),
vec3(0.0941176,0.996078,0.454902), vec3(0.286275,0.894118,0.0470588), vec3(0.45098,0.603922,0.627451), vec3(0.717647,0.623529,0.827451), vec3(0.239216,0.901961,0.552941),
vec3(0.0784314,0.494118,0.34902), vec3(0.572549,0.14902,0.803922), vec3(0.976471,0.666667,0.0431373), vec3(0.85098,0.866667,0.105882), vec3(0.819608,0.639216,0.0745098),
vec3(0.14902,0.498039,0.462745), vec3(0.721569,0.870588,0.956863), vec3(0.607843,0.521569,0.784314), vec3(0.501961,0.101961,0.321569), vec3(0.490196,0.113725,0.662745),
vec3(0.529412,0.686275,0.380392), vec3(0.862745,0.619608,0.0980392), vec3(0.356863,0.54902,0.784314), vec3(0.94902,0.741176,0.129412), vec3(0.843137,0.129412,0.635294),
vec3(0.705882,0.12549,0.0117647), vec3(0.317647,0.337255,0.623529), vec3(0.796078,0.607843,0.52549), vec3(0.854902,0.133333,0.25098), vec3(0.309804,0.223529,0.545098),
vec3(0.788235,0.894118,0.784314), vec3(0.227451,0.862745,0.227451), vec3(0.423529,0.521569,0.0784314), vec3(0.929412,0.121569,0.145098), vec3(0.431373,0.396078,0.913725),
vec3(0.258824,0.396078,0.690196), vec3(0.254902,0.584314,0.239216), vec3(0.6,0.937255,0.00392157), vec3(0.415686,0.00392157,0.380392), vec3(0.690196,0.658824,0.807843),
vec3(0.776471,0.72549,0.686275), vec3(0.945098,0.54902,0.0823529), vec3(0.921569,0.290196,0.619608), vec3(0.901961,0.517647,0.239216), vec3(0.972549,0.168627,0.780392),
vec3(0.113725,0.74902,0), vec3(0.247059,0.188235,0.25098), vec3(0.643137,0.776471,0.192157), vec3(0.635294,0.14902,0.662745), vec3(0.254902,0.533333,0.576471),
vec3(0.388235,0.0666667,0.196078), vec3(0.603922,0.45098,0.643137), vec3(0.196078,0.592157,0.835294), vec3(0.572549,0.894118,0.184314), vec3(0.403922,0.258824,0.282353),
vec3(0.901961,0.396078,0.392157), vec3(0.733333,0.745098,0.733333), vec3(0.364706,0.909804,0.678431), vec3(0.435294,0.65098,0.517647), vec3(0.305882,0.352941,0.027451),
vec3(0.196078,0.721569,0.67451), vec3(0.0470588,0.545098,0.0980392), vec3(0.690196,0.678431,0.529412), vec3(0.309804,0.0588235,0.168627), vec3(0.505882,0.439216,0.00784314),
vec3(0.619608,0.941176,0.839216), vec3(0.282353,0.305882,0.384314), vec3(0.854902,0.454902,0.027451), vec3(0.580392,0.87451,0.807843), vec3(0.568627,0.588235,0.588235),
vec3(0.231373,0.341176,0.266667), vec3(0.890196,0.627451,0.72549), vec3(0.898039,0.196078,0.964706), vec3(0.615686,0.184314,0.627451), vec3(0.478431,0.713725,0.168627),
};*/

void main() {
	vec4 pixel = vec4(0.0, 0.0, 0.0, 1.0);
  	ivec2 pixel_coords = ivec2(gl_GlobalInvocationID.xy);
  	vec2 pixel_position = pixel_coords / resolution;
	//float deltaTime2 = deltaTime % int(2659 * 1e10);
	
	pixel = vec4(deltaTime == 0, 0.0,0.0,1.0);
  	imageStore(img_output, pixel_coords, pixel);
  	return;
	
	float best_dist = 999999;
	int best_index;
	for(int i = 0; i < 20; i ++) {
		//points[i] += vel[i] * deltaTime;
		float dist = 0;abs(points[i].x - pixel_coords.x + vel[i].x * deltaTime ) + abs(points[i].y - pixel_coords.y);
		if(dist < best_dist) {
			best_dist = dist;
			best_index = i;
		}
	}

	pixel = vec4(col[best_index],1.0);
  	//imageStore(img_output, pixel_coords, pixel);
}